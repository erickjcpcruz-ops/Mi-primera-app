// 1. Configuración de conexión (Asegúrate de tener tus llaves arriba)
let saldo = parseInt(localStorage.getItem('puntos')) || 0;
document.getElementById('balance').innerText = saldo;

async function mostrarAnuncio() {
    AniAds.showRewardedVideo({
        onComplete: async () => {
            // Sumar puntos localmente
            saldo += 50;
            localStorage.setItem('puntos', saldo);
            document.getElementById('balance').innerText = saldo;

            // ENVIAR A SUPABASE (El puente que faltaba)
            const { data, error } = await supabase
                .from('Profiles') // Tu tabla con P mayúscula
                .upsert({ 
                    id: 1, // ID temporal para pruebas
                    points999: saldo // Tu columna points999
                });

            if (error) {
                console.error("Error al guardar:", error);
            } else {
                alert("¡Puntos guardados en la nube!");
            }
        }
    });
}
